<!doctype html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Extranet Hidrospa</title>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/style.css">
</head>

<body class="dashboard-body">

<h2>Extranet Hidrospa</h2>
<p class="welcome">Hola, <span id="usuario"></span>. Bienvenido ğŸ‘‹</p>

<div class="dashboard-grid">

    <a href="/directory.html" class="dash-card">
        <h3>ğŸ“‡ Directorio</h3>
        <p>Ver contactos de empleados y Ã¡reas.</p>
    </a>

    <a href="/gestionlogistica.html" class="dash-card">
        <h3>ğŸšš GestiÃ³n logÃ­stica</h3>
        <p>Control de despachos, cargues y entregas.</p>
    </a>

    <a href="/gestiontecnica.html" class="dash-card">
        <h3>ğŸ›  GestiÃ³n tÃ©cnica</h3>
        <p>Soporte tÃ©cnico, garantÃ­as y asistencia.</p>
    </a>

    <a href="/password.html" class="dash-card">
        <h3>ğŸ” Cambiar contraseÃ±a</h3>
        <p>Actualiza tu clave de seguridad.</p>
    </a>

</div>

<button class="logout" id="logoutBtn">Cerrar sesiÃ³n</button>

<script>
    const token = localStorage.getItem('token');
    if (!token) {
        location.href = '/index.html';
    }

    fetch('/auth/me', {
        headers: {"Authorization": "Bearer " + token}
    })
        .then(r => r.json())
        .then(data => {
            const nombreCompleto = data.full_name || data.email;
            const primerNombre = nombreCompleto.split(" ")[0]; // âœ… Solo primer nombre
            document.getElementById('usuario').textContent = primerNombre;
            localStorage.setItem('full_name', data.full_name || '');
            localStorage.setItem('email', data.email || '');
        })
        .catch(() => {
            localStorage.clear();
            location.href = '/index.html';
        });

    document.getElementById('logoutBtn').onclick = () => {
        localStorage.clear();
        location.href = '/index.html';
    };
</script>


</body>
</html>
